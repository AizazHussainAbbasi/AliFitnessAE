(function(n){function o(n,t){abp.message.confirm(abp.utils.formatString(f("AreYouSureWantToDelete"),t),null,t=>{t&&u.delete({id:n}).done(()=>{abp.notify.info(f("SuccessfullyDeleted")),r.ajax.reload()})})}var u=abp.services.app.user,f=abp.localization.getSource("AliFitnessAE"),i=n("#UserCreateModal"),t=i.find("form").attr("autocomplete","off"),e=n("#UsersTable"),r=e.DataTable({paging:!0,serverSide:!0,ajax:function(t,i){var r=n("#UsersSearchForm").serializeFormToObject(!0);r.maxResultCount=t.length;r.skipCount=t.start;abp.ui.setBusy(e);u.getAll(r).done(function(n){i({recordsTotal:n.totalCount,recordsFiltered:n.totalCount,data:n.items})}).always(function(){abp.ui.clearBusy(e)})},buttons:[{name:"refresh",text:'<i class="fas fa-redo-alt"><\/i>',action:()=>r.draw(!1)}],responsive:{details:{type:"column"}},columnDefs:[{targets:0,className:"control",defaultContent:""},{targets:1,data:null,sortable:!1,autoWidth:!1,defaultContent:"",render:(n,t,i)=>{var r="";return r+=`<div class="btn-group">`,r+=`<button class="btn btn-primary btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">`,r+=`<span class="caret"></span>`,r+=`</button>`,r+=`<div class="dropdown-menu">`,r+=` <a class="dropdown-item edit-user" data-user-id="${i.id}" data-toggle="modal" data-target="#UserEditModal">Edit</a>`,r+=` <a class="dropdown-item delete-user" data-user-id="${i.id}" data-user-name="${i.name}">Delete</a>`,isAdminLoggedIn&&(r+=` <a class="dropdown-item goto-profile-user" data-user-id="${i.id}">GotProfile</a>`),r+=`</div>`,r+`</div>`}},{targets:2,data:"userName",sortable:!1},{targets:3,data:"fullName",sortable:!1},{targets:4,data:"emailAddress",sortable:!1},{targets:5,data:"isActive",sortable:!1,render:n=>`<input type="checkbox" disabled ${n?"checked":""}>`}]});t.validate({rules:{Password:"required",ConfirmPassword:{equalTo:"#Password"}}});t.find(".save-button").on("click",e=>{var o,s,h,c;if(e.preventDefault(),t.valid()){if(o=t.serializeFormToObject(),o.roleNames=[],s=t[0].querySelectorAll("input[name='role']:checked"),s)for(h=0;h<s.length;h++)c=n(s[h]),o.roleNames.push(c.val());abp.ui.setBusy(i);u.create(o).done(function(){i.modal("hide");t[0].reset();abp.notify.info(f("SavedSuccessfully"));r.ajax.reload()}).always(function(){abp.ui.clearBusy(i)})}});n(document).on("click",".delete-user",function(){var t=n(this).attr("data-user-id"),i=n(this).attr("data-user-name");o(t,i)});n(document).on("click",".edit-user",function(t){var i=n(this).attr("data-user-id");t.preventDefault();abp.ajax({url:abp.appPath+"Admin/Users/EditModal?userId="+i,type:"POST",dataType:"html",success:function(t){n("#UserEditModal div.modal-content").html(t)},error:function(){}})});n(document).on("click",".goto-profile-user",function(t){var i=n(this).attr("data-user-id");t.preventDefault();abp.ajax({url:abp.appPath+"Admin/Users/GotoUserProfile?userId="+i,type:"POST",dataType:"html",success:function(n){var t=jQuery.parseJSON(n);t.result!=null&&t.result.success?window.location.href=t.result.targetUrl:abp.message.error("URL is wrong,please contact with Admin","Error Occurred")},error:function(){}})});n(document).on("click",'a[data-target="#UserCreateModal"]',()=>{n('.nav-tabs a[href="#user-details"]').tab("show")});abp.event.on("user.edited",()=>{r.ajax.reload()});i.on("shown.bs.modal",()=>{i.find("input:not([type=hidden]):first").focus()}).on("hidden.bs.modal",()=>{t.clearForm()});n(".btn-search").on("click",()=>{r.ajax.reload()});n(".txt-search").on("keypress",n=>{if(n.which==13)return r.ajax.reload(),!1});n("#AddUserType").select2({placeholder:"Select",theme:"bootstrap4",allowClear:!0,dropdownParent:n("#UserCreateModal .modal-content")});n("#AddGender").select2({placeholder:"Select",theme:"bootstrap4",allowClear:!0,dropdownParent:n("#UserCreateModal .modal-content")});n("#AddUserDOB").datepicker({format:"mm/dd/yyyy",startView:2,clearBtn:!0,endDate:"+0d"})})(jQuery);